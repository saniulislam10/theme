{%- liquid
  assign current_variant = product.selected_or_first_available_variant
  assign featured_image = current_variant.featured_image | default: product.featured_image
  assign product_description = product.description | split: '<!-- split -->'
-%}

<div class="product" data-section-id="{{ section.id }}" data-section-type="product">
  <div class="product__container">
    <div class="product__gallery">
      <div class="product__main-image">
        {%- if featured_image != blank -%}
          <img
            src="{{ featured_image | img_url: '1200x' }}"
            alt="{{ featured_image.alt | escape }}"
            class="product__image"
            loading="lazy"
            width="{{ featured_image.width }}"
            height="{{ featured_image.height }}"
          >
        {%- else -%}
          {{ 'product-1' | placeholder_svg_tag: 'product__image product__image--placeholder' }}
        {%- endif -%}
      </div>

      {%- if product.images.size > 1 -%}
        <div class="product__thumbnails">
          {%- for image in product.images -%}
            <div class="product__thumbnail">
              <img
                src="{{ image | img_url: '300x' }}"
                alt="{{ image.alt | escape }}"
                class="product__thumbnail-image"
                loading="lazy"
                width="{{ image.width }}"
                height="{{ image.height }}"
              >
            </div>
          {%- endfor -%}
        </div>
      {%- endif -%}
    </div>

    <div class="product__info">
      <h1 class="product__title">{{ product.title }}</h1>
      
      <div class="product__price">
        {%- if current_variant.compare_at_price > current_variant.price -%}
          <span class="product__price--sale">
            {{ current_variant.price | money }}
          </span>
          <span class="product__price--compare">
            {{ current_variant.compare_at_price | money }}
          </span>
        {%- else -%}
          {{ current_variant.price | money }}
        {%- endif -%}
      </div>

      {%- if product_description[0] != blank -%}
        <div class="product__description">
          {{ product_description[0] }}
        </div>
      {%- endif -%}

      <form method="post" action="/cart/add" class="product__form" id="AddToCartForm">
        <input type="hidden" name="id" value="{{ current_variant.id }}">
        
        {%- if product.variants.size > 1 -%}
          <div class="product__variants">
            {%- for option in product.options_with_values -%}
              <div class="product__option">
                <label class="product__option-label" for="Option-{{ section.id }}-{{ forloop.index0 }}">
                  {{ option.name }}
                </label>
                <select
                  id="Option-{{ section.id }}-{{ forloop.index0 }}"
                  class="product__option-select"
                  name="options[{{ option.name }}]"
                  form="AddToCartForm"
                >
                  {%- for value in option.values -%}
                    <option
                      value="{{ value | escape }}"
                      {% if option.selected_value == value %}selected{% endif %}
                    >
                      {{ value }}
                    </option>
                  {%- endfor -%}
                </select>
              </div>
            {%- endfor -%}
          </div>
        {%- endif -%}

        <div class="product__quantity">
          <label class="product__quantity-label" for="Quantity-{{ section.id }}">
            {{ 'products.product.quantity.label' | t }}
          </label>
          <input
            type="number"
            id="Quantity-{{ section.id }}"
            name="quantity"
            value="1"
            min="1"
            class="product__quantity-input"
          >
        </div>

        <button
          type="submit"
          name="add"
          class="product__add-to-cart button"
          {% unless current_variant.available %}disabled{% endunless %}
        >
          {%- if current_variant.available -%}
            {{ 'products.product.add_to_cart' | t }}
          {%- else -%}
            {{ 'products.product.sold_out' | t }}
          {%- endif -%}
        </button>
      </form>

      {%- if product_description[1] != blank -%}
        <div class="product__additional-info">
          {{ product_description[1] }}
        </div>
      {%- endif -%}

      {%- if section.settings.show_share_buttons -%}
        <div class="product__share">
          <span class="product__share-label">{{ 'general.social.share_on_facebook' | t }}</span>
          <a
            href="https://www.facebook.com/sharer/sharer.php?u={{ shop.url | append: product.url }}"
            class="product__share-button"
            target="_blank"
            rel="noopener"
          >
            {% render 'icon-facebook' %}
          </a>
        </div>
      {%- endif -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Product",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_share_buttons",
      "label": "Show social sharing buttons",
      "default": true
    }
  ]
}
{% endschema %} 